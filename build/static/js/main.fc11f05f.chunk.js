(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{161:function(e,t,a){e.exports=a(395)},394:function(e,t,a){},395:function(e,t,a){"use strict";a.r(t);var r={};a.r(r),a.d(r,"setUser",function(){return X}),a.d(r,"setUserLoading",function(){return Y}),a.d(r,"fetchUser",function(){return Z});var n=a(1),o=a.n(n),s=a(2),c=a.n(s),l=a(402),i=a(36),u=a(29),m=a(155),p=a(75),d=a.n(p),f=d.a.fromJS({user:null,loading:!1}),h=Object(u.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return e.set("user",t.data);case"SET_USER_LOADING":return e.set("loading",t.data);default:return e}}}),g=Object(u.d)(h,Object(u.a)(m.a)),E=(a(170),a(160)),y=a.n(E),b=a(22),v=a(23),w=a(25),O=a(24),j=a(26),S=(a(116),a(51)),P=a.n(S),x=a(400),T=a(403),k=(a(81),a(59)),N=a.n(k),L=(a(117),a(45)),D=a.n(L),U=(a(82),a(11)),C=a.n(U),F=(a(118),a(44)),I=a.n(F),M=(a(119),a(38)),_=a.n(M),q=a(35),A=a.n(q),K=a(399),R=_.a.Item,B=function(e){function t(){var e,a;Object(b.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(w.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(n)))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||A.a.post("/api/auth/login",{username:t.username,password:t.password}).then(function(e){window.location.href="/"}).catch(function(e){401===e.response.status?I.a.error("Login failed: user not exist or password incorrect."):I.a.error("Login failed")})})},a}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return o.a.createElement(_.a,{onSubmit:this.handleSubmit,className:"login-form"},o.a.createElement("h1",null,"Login"),o.a.createElement(R,null,e("username",{rules:[{required:!0,message:"Please input your username!"},{type:"email",message:"The input is not valid E-mail!"}]})(o.a.createElement(D.a,{prefix:o.a.createElement(C.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),o.a.createElement(R,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(o.a.createElement(D.a,{prefix:o.a.createElement(C.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),o.a.createElement(R,null,o.a.createElement(N.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"),"Or ",o.a.createElement(K.a,{to:"/register"},"sign up now!")))}}]),t}(o.a.PureComponent),H=_.a.create()(B),J=function(e){function t(){return Object(b.a)(this,t),Object(w.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-xs-12"},o.a.createElement("p",null,"home"))))}}]),t}(n.PureComponent),z=Object(i.b)(function(e){return{user:e.user}})(J),G=a(401),V=_.a.Item,W=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(w.a)(this,Object(O.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||A.a.post("/api/auth/register",{username:t.username,password:t.password}).then(function(e){I.a.success("Sign up success."),a.setState({redirectToLogin:!0})}).catch(function(e){406===e.response.status?I.a.error("Sign up failed: user already exist."):I.a.error("Sign up failed")})})},a.validateToNextPassword=function(e,t,r){var n=a.props.form;t&&a.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),r()},a.compareToFirstPassword=function(e,t,r){var n=a.props.form;t&&t!==n.getFieldValue("password")?r("Two passwords that you enter is inconsistent!"):r()},a.handleConfirmBlur=function(e){var t=e.target.value;a.setState({confirmDirty:a.state.confirmDirty||!!t})},a.state={confirmDirty:!1,redirectToLogin:!1},a}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){if(this.state.redirectToLogin)return o.a.createElement(G.a,{to:"/login"});var e=this.props.form.getFieldDecorator;return o.a.createElement(_.a,{onSubmit:this.handleSubmit,className:"login-form"},o.a.createElement("h1",null,"Sign up"),o.a.createElement(V,{label:"Username"},e("username",{rules:[{required:!0,message:"Please input your username!"},{type:"email",message:"The input is not valid E-mail!"}]})(o.a.createElement(D.a,{prefix:o.a.createElement(C.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),o.a.createElement(V,{label:"Password"},e("password",{rules:[{required:!0,message:"Please input your Password!"},{validator:this.validateToNextPassword}]})(o.a.createElement(D.a,{prefix:o.a.createElement(C.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),o.a.createElement(V,{label:"Confirm password"},e("confirm",{rules:[{required:!0,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]})(o.a.createElement(D.a,{prefix:o.a.createElement(C.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Confirm password",onBlur:this.handleConfirmBlur}))),o.a.createElement(V,null,o.a.createElement(N.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Sign up!")))}}]),t}(n.PureComponent),Q=_.a.create()(W),X=function(e){return{type:"SET_USER",data:e}},Y=function(e){return{type:"SET_USER_LOADING",data:e}},Z=function(){return function(e){e(Y(!0)),A.a.post("/api/auth/current").then(function(t){var a=t.data;a&&e(X(d.a.fromJS(a))),e(Y(!1))})}},$=(a(373),a(52)),ee=a.n($);function te(e){return function(t){return e?t:null}}var ae=ee.a.SubMenu,re=P.a.Header,ne=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(w.a)(this,Object(O.a)(t).call(this,e))).correctSelectedMenu=function(){var e=a.props.location.pathname;if("/"===e)a.setState({selectedKeys:["/"]});else try{a.setState({selectedKeys:["/"+e.split("/")[1]]})}catch(t){console.error(t)}},a.componentDidMount=function(){a.correctSelectedMenu()},a.componentDidUpdate=function(e,t,r){e.location.pathname!==a.props.location.pathname&&a.correctSelectedMenu()},a.onLogout=function(){A.a.post("/api/auth/logout").then(function(e){window.location.href="/"})},a.state={selectedKeys:[]},a}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.user.get("user"),t=this.props.user.getIn(["user","username"],"");return o.a.createElement(re,null,o.a.createElement("div",{className:"logo"}),o.a.createElement(ee.a,{theme:"dark",mode:"horizontal",selectedKeys:this.state.selectedKeys,style:{lineHeight:"64px"}},o.a.createElement(ee.a.Item,{key:"/"},o.a.createElement(K.a,{to:"/"},"Home")),te(e)(o.a.createElement(ae,{style:{float:"right"},title:o.a.createElement("span",null,o.a.createElement("span",null,"Welcome, ",t,"\xa0"),o.a.createElement(C.a,{type:"caret-down",theme:"outlined"}))},o.a.createElement(ee.a.Item,{key:"/logout"},o.a.createElement("a",{role:"button",onClick:this.onLogout},"Logout")))),te(!e)(o.a.createElement(ee.a.Item,{key:"/login",style:{float:"right"}},o.a.createElement(K.a,{to:"/login"},"Login")))))}}]),t}(n.PureComponent),oe=Object(T.a)(Object(i.b)(function(e){return{user:e.user}})(ne)),se=P.a.Content,ce=P.a.Footer,le=function(e){function t(){var e,a;Object(b.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(w.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(n)))).componentDidMount=function(){a.props.actions.fetchUser()},a}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return this.props.user.get("loading")?o.a.createElement("div",{className:"loading-container"},o.a.createElement(y.a,{size:"large"})):o.a.createElement(P.a,{className:"layout"},o.a.createElement(oe,null),o.a.createElement(se,{style:{padding:"0 50px"}},o.a.createElement("div",{style:{background:"#fff",padding:24,minHeight:280,marginTop:50}},o.a.createElement(x.a,{exact:!0,path:"/",component:z}),o.a.createElement(x.a,{exact:!0,path:"/login",component:H}),o.a.createElement(x.a,{exact:!0,path:"/register",component:Q}))),o.a.createElement(ce,{style:{textAlign:"center"}},"React Node Starter"))}}]),t}(n.PureComponent),ie=Object(T.a)(Object(i.b)(function(e){return{user:e.user}},function(e){return{actions:Object(u.b)(r,e)}})(le));a(394);c.a.render(o.a.createElement(i.a,{store:g},o.a.createElement(l.a,null,o.a.createElement(ie,null))),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.fc11f05f.chunk.js.map